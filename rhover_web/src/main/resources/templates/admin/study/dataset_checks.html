<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head> 
    <title>RhoVer Univariate Settings</title> 
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="/rhover.css"/>
    <link rel="stylesheet" href="/jquery-ui.css"/>
    <script src="/jquery-3.2.1.min.js"></script>
    <script src="/jquery-ui.js"></script>
</head>
<body>
	<div class="page-header">RhoVer (Prototype)</div>
	
	<div class="menu-bar">
		<ul>
			<li><a href="/">Home</a></li>
			<li><a href="/browse/studies">Browse</a></li>
			<li><a href="/search/form">Search</a></li>
			<li><a href="/admin/study/all" class="active-menu-item">Admin</a></li>
		</ul>
	</div>
		
    <div id="content">
    	<p>
    		<a th:href="@{/admin/study/study_checks(study_id=${study.studyId})}">Study-Level Settings</a> |
    		<strong>Individual Dataset Settings</strong>
    	</p>
    
   		<p>
    	Select Dataset:
   		<select name="dataset_id" id="select_dataset">
   			<option value="-1">--- Select ---</option>
   			<option th:each="datasetVersion : ${studyDbVersion.datasetVersions}"
   				th:value="${datasetVersion.dataset.datasetId}" th:text="${datasetVersion.dataset.datasetName}"
   				th:selected="${datasetVersion.dataset.datasetId} == ${dataset_id}"/>
   		</select>
	   	</p>
	   	
	   	<div th:if="${fields}">
	   		<table class="wide">
	   			<tr>
	   				<th>Data Type</th>
	   				<th>Variable Name</th>
	   				<th>Label</th>
	   			</tr>
	   			<tr th:each="field : ${fields}" th:classappend="${field.isNumeric == false}? 'deactivated' ">
	   				<td th:text="${field.displayDataType}"/>
	   				<td th:text="${field.fieldName}"/>
	   				<td th:text="${field.fieldLabel}" style="text-align: left;"/>
	   			</tr>
	   		</table>
	   	</div>
	   	
	   	<form>
	   		<input type="hidden" name="study_id" id="study_id" th:value="${study.studyId}"/>
	   	</form>
   	</div>
</body>

<script>
	$(function() {
		$("#select_dataset").change(function() {
			const studyId = $("#study_id").val();
			const datasetId = $("#select_dataset").val();
			const url = "/admin/study/dataset_checks?study_id=" + studyId + "\u0026dataset_id=" + datasetId;
			//console.log(url);
			document.location.href = url;
		});
	});
</script>

</html>
